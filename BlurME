#!/bin/sh
while getopts ":w:" c
do
  case "$c" in
    w) wid=$OPTARG ;;
  esac 
done
while sleep 1
do 
if [ $XDG_CURRENT_DESKTOP = "KDE" ]; then
  lswK=$(lsw | wc -l)
  echo $lswK Windows/Widgets Are Open
  if [ -n "$wid" ]; then
    echo "Widget Amount is $wid"
  else
    wid="2"
  fi
  if [ "$lswK" == "$wid" ]; then
    echo "Setting Non-Blurred Wallpaper"
    bash ./wp
  else
    if [ "$lswK" == "1" ]; then
      echo "Setting Non-Blurred Wallpaper"
      bash ./wp
    else 
      echo "Setting Blurred Wallpaper"
      bash ./wp_blur
    fi
  fi
else
  if [ $DESKTOP_SESSION = "/usr/share/xsessions/plasma" ]; then
    lswK=$(lsw | wc -l)
    if [ -n "$wid" ]; then
      echo "Widget Amount is $wid"
    else 
      wid="2"
    fi
    if [ "$lswK" == "$wid" ]; then
      echo "Setting Non-Blurred Wallpaper"
      bash ./wp
    else
      if [ "$lswK" == "1" ]; then
        echo "Setting Non-Blurred Wallpaper"
        bash ./wp_blur 
      else 
        echo "Setting Blurred Wallpaper"
        bash ./wp
      fi
    fi
  else
    bash ./SoWM.blur.sh
  fi
fi 
done
